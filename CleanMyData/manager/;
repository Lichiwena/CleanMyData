from pyspark.sql import SparkSession
import re
spark = SparkSession.builder.getOrCreate()

class xmlReader:
    def __init__(self, spark):
        self.spark = spark
        self.headerRe = re.compile("<[a-zA-Z]*\/?>")
        self.valueRe = re.compile(">.*\/?<")
        self.matchArr = []
        self.valueArr = []
        self.header = []
        self.values = []
        self.readFlag = False

    def getXMLHeader(self, filePath):
        with open(filePath) as f:
            line = f.readline()
            while line:
                line = f.readline()
                if line.strip() == "</row>":
                    self.readFlag = False
                    print("end header lookup")
                    break
                if self.readFlag == True and line.strip() != "":
                    self.matchArr.append(self.headerRe.findall(line))

                if line.strip() == "<row>":
                    self.readFlag = True
                    print("start header lookup")

        for match in matchArr:
            self.match[0] = self.match[0].replace("<", "").replace(">", "").replace("/", "")
            self.header.append(self.match[0])


test = xmlReader(spark)
test.getXMLHeader('employee.xml')
print(test.header)

